import { isValidAcceptedVulnerability } from './isValidAcceptedVulnerability';

describe('isValidAcceptedVulnerability', () => {
  it('should return true for valid vulnerability', () => {
    const vuln = {
      id: 123456,
      reason: 'Test reason',
      acceptedBy: 'test@example.com',
      acceptedAt: '2026-02-09T00:00:00.000Z',
    };

    expect(isValidAcceptedVulnerability(vuln)).toBe(true);
  });

  it('should return true for vulnerability with expiresAt', () => {
    const vuln = {
      id: 123456,
      reason: 'Test reason',
      acceptedBy: 'test@example.com',
      acceptedAt: '2026-02-09T00:00:00.000Z',
      expiresAt: '2026-08-09T00:00:00.000Z',
    };

    expect(isValidAcceptedVulnerability(vuln)).toBe(true);
  });

  it('should return false for non-number id', () => {
    const vuln = {
      id: 'not-a-number',
      reason: 'Test reason',
      acceptedBy: 'test@example.com',
      acceptedAt: '2026-02-09T00:00:00.000Z',
    };

    expect(isValidAcceptedVulnerability(vuln)).toBe(false);
  });

  it('should return false for empty reason', () => {
    const vuln = {
      id: 123456,
      reason: '',
      acceptedBy: 'test@example.com',
      acceptedAt: '2026-02-09T00:00:00.000Z',
    };

    expect(isValidAcceptedVulnerability(vuln)).toBe(false);
  });

  it('should return false for empty acceptedBy', () => {
    const vuln = {
      id: 123456,
      reason: 'Test reason',
      acceptedBy: '',
      acceptedAt: '2026-02-09T00:00:00.000Z',
    };

    expect(isValidAcceptedVulnerability(vuln)).toBe(false);
  });

  it('should return false for invalid acceptedAt date', () => {
    const vuln = {
      id: 123456,
      reason: 'Test reason',
      acceptedBy: 'test@example.com',
      acceptedAt: 'not-a-date',
    };

    expect(isValidAcceptedVulnerability(vuln)).toBe(false);
  });

  it('should return false for invalid expiresAt date', () => {
    const vuln = {
      id: 123456,
      reason: 'Test reason',
      acceptedBy: 'test@example.com',
      acceptedAt: '2026-02-09T00:00:00.000Z',
      expiresAt: 'not-a-date',
    };

    expect(isValidAcceptedVulnerability(vuln)).toBe(false);
  });

  it('should return false for null', () => {
    expect(isValidAcceptedVulnerability(null)).toBe(false);
  });

  it('should return false for non-object', () => {
    expect(isValidAcceptedVulnerability('string')).toBe(false);
  });
});
