import { AcceptedVulnerability } from '../../shared/types';
import { isValidISODate } from './isValidISODate';

/**
 * Check if an object is a valid AcceptedVulnerability
 */
export function isValidAcceptedVulnerability(vuln: unknown): vuln is AcceptedVulnerability {
  if (!vuln || typeof vuln !== 'object') {
    return false;
  }

  const v = vuln as Record<string, unknown>;

  return (
    typeof v.id === 'number' &&
    typeof v.reason === 'string' &&
    v.reason.length > 0 &&
    typeof v.acceptedBy === 'string' &&
    v.acceptedBy.length > 0 &&
    typeof v.acceptedAt === 'string' &&
    isValidISODate(v.acceptedAt) &&
    (v.expiresAt === undefined || (typeof v.expiresAt === 'string' && isValidISODate(v.expiresAt)))
  );
}
