import { Vulnerability, VulnerabilityVia } from '../../shared/types';

/**
 * Extract all vulnerability IDs from a vulnerability entry
 * These are the source IDs from the 'via' array
 */
export function extractVulnerabilityIds(vulnerability: Vulnerability): number[] {
  const ids: number[] = [];

  for (const via of vulnerability.via) {
    if (typeof via === 'object' && 'source' in via) {
      ids.push((via as VulnerabilityVia).source);
    }
  }

  return ids;
}

/**
 * Get the title of the first vulnerability via entry
 */
export function getVulnerabilityTitle(vulnerability: Vulnerability): string {
  for (const via of vulnerability.via) {
    if (typeof via === 'object' && 'title' in via) {
      return (via as VulnerabilityVia).title;
    }
  }
  return vulnerability.title || 'Unknown vulnerability';
}

/**
 * Get the URL of the first vulnerability via entry
 */
export function getVulnerabilityUrl(vulnerability: Vulnerability): string {
  for (const via of vulnerability.via) {
    if (typeof via === 'object' && 'url' in via) {
      return (via as VulnerabilityVia).url;
    }
  }
  return vulnerability.url || '';
}
